---
apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: probate-demo
  namespace: probate
  annotations:
    flux.weave.works/automated: 'true'
    # flux.weave.works/tag.java: 'glob:prod-*'

spec:
  releaseName: probate-demo
  timeout: 900
  forceUpgrade: true
  rollback:
    enable: true
    force: true
  chart:
    repository: 'https://hmctspublic.azurecr.io/helm/v1/repo/'
    name: probate
    version: 2.0.1
  values:
    tags:
      idam-pr: true
    global:
      ccdIngress: probate-ccd.demo.platform.hmcts.net
    # Enable support services tags 
    # TODO to be enabled these in product chart instead of here 
    ccd-elasticsearch:
      ccd:
        idamApiUrl: https://idam-api.demo.platform.hmcts.net
        idamWebUrl: https://idam-web-public.demo.platform.hmcts.net
        ingressHost: probate-ccd.demo.platform.hmcts.net
        idam-pr:
          api:
            url: https://idam-api.demo.platform.hmcts.net
          web_public:
            url: https://idam-web-public.demo.platform.hmcts.net
          releaseNameOverride: cmc-demo-ccd-idam-pr


