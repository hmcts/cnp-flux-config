---
apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: idam-probate
  namespace: probate
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: idam-probate
  rollback:
    enable: true
  chart:
    repository: https://hmctspublic.azurecr.io/helm/v1/repo/
    name: idam-preview
    version: 1.2.1
  values:
    idam-api:
      java:
        ingressIP: 10.97.17.51
        consulIP: 10.97.11.254
    idam-web-public:
      java:
        ingressIP: 10.97.17.51
        consulIP: 10.97.11.254
    configurer:
      enabled: true
      services:
        - label: CCD
          clientID: ccd_gateway
          clientSecret: ccd_gateway_secret
          redirectURL: http://localhost:3451/oauth2redirect
        - label: Probate
          clientID: probate
          clientSecret: probate_secret
          redirectURL: https://localhost:3000/oauth2/callback
      roles:
        - id: ccd-import
        - id: payment
        - id: caseworker
        - id: caseworker-probate
        - id: caseworker-probate-issuer
        - id: caseworker-probate-solicitor
        - id: caseworker-probate-authoriser
        - id: caseworker-probate-systemupdate
        - id: caseworker-probate-pcqextractor
        - id: caseworker-probate-caseofficer
        - id: caseworker-probate-caseadmin
        - id: caseworker-probate-registrar
        - id: caseworker-probate-superuser
        - id: caseworker-probate-scheduler
        - id: caseworker-probate-bulkscan
      users:
        - email: ccd.docker.default@hmcts.net
          group: caseworker
          roles:
            - ccd-import

    global:
      tenantId: 531ff96d-0ae9-462a-8d2d-bec7c0b42082
      keyVaultName: probate-aat
