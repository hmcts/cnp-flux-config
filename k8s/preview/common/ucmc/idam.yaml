---
apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: idam-ucmc
  namespace: ucmc
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: idam-ucmc
  rollback:
    enable: true
  chart:
    repository: https://hmctspublic.azurecr.io/helm/v1/repo/
    name: idam-preview
    version: 1.2.1
  values:
    idam-api:
      java:
        ingressIP: 10.97.17.51
        consulIP: 10.97.11.254
    idam-web-public:
      java:
        ingressIP: 10.97.17.51
        consulIP: 10.97.11.254
    configurer:
      enabled: true
      services:
        - label: CCD
          clientID: ccd_gateway
          clientSecret: ccd_gateway_secret
          redirectURL: http://localhost:3451/oauth2redirect
        - label: UCMC
          clientID: ucmc_service
          clientSecret: ucmc_service_secret
          redirectURL: https://localhost:9000/oauth2/callback
      roles:
        - id: ccd-import
        - id: caseworker
        - id: caseworker-cmc
        - id: caseworker-cmc-solicitor
      users:
        - email: ccd.docker.default@hmcts.net
          group: caseworker
          roles:
            - ccd-import
        - email: solicitor@example.com
          forename: example
          surname: solicitor
          group: caseworker
          roles:
            - caseworker
            - caseworker-cmc
            - caseworker-cmc-solicitor
    global:
      tenantId: 531ff96d-0ae9-462a-8d2d-bec7c0b42082
      keyVaultName: ucmc-aat
