apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base
  - ../../base/gotk-components.yaml
  - ../../workload-identity
  - aso-controller-settings-patch.yaml
  - ../../docker-regcreds/aat
patches:
  - path: ../../serviceaccount/aat.yaml
  - path: ../../serviceaccount/aat-source-controller.yaml
  - path: ../../base/patches/workload-identity-deployment-patch.yaml
  - path: ../../base/patches/workload-identity-source-controller-patch.yaml
  - path: ../../base/patches/helm-controller-size-limit-patch.yaml
  - patch: |-
      - op: add
        path: /spec/template/spec/containers/0/args/-
        value: --concurrent=10
    target:
      kind: Deployment
      name: helm-controller
      namespace: flux-system