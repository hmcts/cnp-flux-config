apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: expressjs-monorepo-template
spec:
  releaseName: expressjs-monorepo-template
  interval: 5m
  values:
    global:
      environment: aat
    postgres:
      enabled: true
    web:
      enabled: true
    api:
      enabled: true
    crons:
      enabled: true
    postgresql:
      enabled: false
    redis:
      enabled: false
    expressjs-monorepo-template-web:
      nodejs:
        image: hmctspublic.azurecr.io/dtsse/expressjs-monorepo-template-web:prod-0000000-00000000000000 # {"$imagepolicy": "flux-system:expressjs-monorepo-template-web"}
    expressjs-monorepo-template-api:
      nodejs:
        image: hmctspublic.azurecr.io/dtsse/expressjs-monorepo-template-api:prod-0000000-00000000000000 # {"$imagepolicy": "flux-system:expressjs-monorepo-template-api"}
    expressjs-monorepo-template-crons:
      job:
        image: hmctspublic.azurecr.io/dtsse/expressjs-monorepo-template-crons:prod-0000000-00000000000000 # {"$imagepolicy": "flux-system:expressjs-monorepo-template-crons"}
    expressjs-monorepo-template-postgres:
      nodejs:
        image: hmctspublic.azurecr.io/dtsse/expressjs-monorepo-template-postgres:prod-0000000-00000000000000 # {"$imagepolicy": "flux-system:expressjs-monorepo-template-postgres"}
  chart:
    spec:
      chart: expressjs-monorepo-template
      version: ">=0.0.1-0"
      sourceRef:
        kind: HelmRepository
        name: hmctspublic-oci
        namespace: flux-system
      interval: 1m
