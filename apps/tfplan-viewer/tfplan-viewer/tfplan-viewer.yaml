apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: tfplan-viewer
  namespace: tfplan-viewer
spec:
  releaseName: tfplan-viewer
  values:
    applicationPort: 8080
    disableTraefikTls: false
    environment:
      USE_MANAGED_IDENTITY: true
    image: hmctspublic.azurecr.io/rpe/tfplan-viewer:prod-848cb5a6-1761140735 #{"$imagepolicy": "flux-system:tfplan-viewer"}
    ingressHost: tfplan-viewer.platform.hmcts.net
    livenessPath: /health
    readinessPath: /health
    replicas: 1
    startupPath: /health
  chart:
    spec:
      chart: nodejs
      version: 3.0.0
      sourceRef:
        kind: HelmRepository
        name: hmctspublic-oci
        namespace: flux-system
