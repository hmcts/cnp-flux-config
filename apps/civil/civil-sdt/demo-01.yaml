apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: civil-sdt
  namespace: civil
spec:
  values:
    java:
      image: hmctspublic.azurecr.io/civil/sdt:prod-1da7bf6-20231020143222 #{"$imagepolicy": "flux-system:demo-civil-sdt"}
      environment:
        PURGE_SCHEDULE_CRON: 0 15 0 * * 1,2,3
        LOGGING_LEVEL_UK_GOV_MOJ_SDT: DEBUG
        SDT_DB_HOST: civil-sdt-demo.postgres.database.azure.com
        SDT_DB_USERNAME: pgadmin
      keyVaults:
        civil-sdt:
          secrets:
            - name: civil-sdt-POSTGRES-USER-V15
              alias: SDT_DB_USERNAME
            - name: civil-sdt-POSTGRES-PASS-V15
              alias: SDT_DB_PASSWORD
            - name: civil-sdt-POSTGRES-HOST-V15
              alias: SDT_DB_HOST