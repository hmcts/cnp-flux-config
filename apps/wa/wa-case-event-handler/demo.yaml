apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: wa-case-event-handler
spec:
  values:
    java:
      image: hmctspublic.azurecr.io/wa/case-event-handler:prod-3040d59-20240603161721 #{"$imagepolicy": "flux-system:demo-wa-case-event-handler"}
      environment:
        replicas: 2
        REFRESH_FLAG: "0"
        AZURE_SERVICE_BUS_FEATURE_TOGGLE: true
        LOGGING_LEVEL_UK_GOV_HMCTS: DEBUG
        TEMP_RESTART: true
        NEW_MESSAGE_LIVENESS_STATE_HEALTH_CHECK: demo
        PROBLEM_MESSAGE_RESET_ID_LIST: ID:c333ef46-362c-4a03-a9d0-31f093119b2f:4:1:1-4, ID:ed0682db-8f71-4bf7-8297-6315131d274c:4:1:1-4, ID:86dfec7a-1f45-42dd-9498-659486472ae0:4:1:1-7, ID:5faf8ef1-d6a4-4a6a-bc03-c5ec0e7b7656:4:1:1-7, ID:7f757c1e-1c22-45ae-925d-09c0366b4d7f:3:1:1-1, ID:0620fb1f-7738-4efa-9272-3e687951ce5c:3:1:1-1, ID:c76f0f77-7581-412d-90e2-9c1eccd5ac3b:26:1:1-2, ID:86ec2e02-a236-4e52-85f2-05b9070a818c:27:1:1-2, ID:24554020-eb50-4233-b835-066ca949a9ba:64:1:1-43, ID:914ba4d6-2553-45a1-9bbf-799b262c783d:64:1:1-43, ID:d5ea2d80-966c-4787-8a12-95715f821522:15:1:1-3, ID:c6c9dd61-30d7-49c1-a124-bb903be7be51:8:1:1-3, ID:9a97c98f-70ed-47b4-a41d-258c5d66d149:8:1:1-102, ID:accfcab7-f3c3-4a3e-b439-4a4c99e61b50:8:1:1-105, ID:2309f22b-5ef3-4c3f-b160-d67b12616eb5:7:1:1-56, ID:30ced572-17c8-479e-a44d-35ec8806e3b4:13:1:1-1, ID:dde8958d-858b-434a-aa18-171540a92400:14:1:1-1, ID:66b38635-40e4-4cf1-a55c-56929902603b:5:1:1-171, ID:47b47d5f-b869-46d8-b844-73d5a39d85d8:5:1:1-171, ID:453c1c92-c93b-4e31-b455-5e0b9eb34381:1:1:1-1, ID:a569439d-a7db-40b4-aba9-c54acf524115:1:1:1-2, ID:b943ffe0-2391-47b3-a520-0a73381f4ef3:84:1:1-1, ID:bbcd80f9-39cf-4a6d-9d5f-f678a25e2aac:24:1:1-1, ID:83b0847e-4738-4eb3-a318-01c23a3f14c3:99:1:1-1
        enabled: true
      keyVaults:
        wa:
          secrets:
            - name: app-insights-connection-string
              alias: app-insights-connection-string
            - name: s2s-secret-case-event-handler
              alias: S2S_SECRET_CASE_EVENT_HANDLER
            - name: ccd-shared-servicebus-connection-string
              alias: AZURE_SERVICE_BUS_CONNECTION_STRING
            - name: ld-secret
              alias: LAUNCH_DARKLY_SDK_KEY
            - name: wa-case-event-handler-POSTGRES-USER-V15
              alias: POSTGRES_USERNAME
            - name: wa-case-event-handler-POSTGRES-PASS-V15
              alias: POSTGRES_PASSWORD
            - name: wa-case-event-handler-POSTGRES-HOST-V15
              alias: POSTGRES_HOST
            - name: wa-case-event-handler-POSTGRES-PORT-V15
              alias: POSTGRES_PORT
            - name: wa-case-event-handler-POSTGRES-DATABASE-V15
              alias: POSTGRES_NAME
            - name: wa-idam-client-secret
              alias: WA_IDAM_CLIENT_SECRET
