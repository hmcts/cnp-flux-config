apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: fis-cos-api
spec:
  values:
    java:
      image: hmctspublic.azurecr.io/fis/cos-api:pr-200-238c7a5-20231017144737 #{"$imagepolicy": "flux-system:demo-fis-cos-api"}
      useInterpodAntiAffinity: true
      keyVaults:
        fis-kv:
          secrets:
            - redis-access-key
            - redis-access-key-v6
            - AppInsightsInstrumentationKey
            - idam-system-user-name
              alias: IDAM_SYSTEM_UPDATE_USERNAME
            - idam-system-user-password
              alias: IDAM_SYSTEM_UPDATE_PASSWORD
            - s2s-secret-fis-cos-api
              alias: S2S_SECRET
            - idam-ui-secret
              alias: OAUTH2_CLIENT_SECRET
      environment:
        IDAM_API_URL: https://idam-api.demo.platform.hmcts.net
        IDAM_API_BASEURL: https://idam-api.demo.platform.hmcts.net
        IDAM_WEB_URL: https://idam-web-public.demo.platform.hmcts.net/login
        SERVICE_AUTH_PROVIDER_URL: http://rpe-service-auth-provider-demo.service.core-compute-demo.internal
        CASE_DATA_STORE_BASEURL: http://ccd-data-store-api-demo.service.core-compute-demo.internal
        CCD_CASE_DOCS_AM_API: http://ccd-case-document-am-api-demo.service.core-compute-demo.internal
        DUMMY_VAR_TO_REDEPLOY: 2
