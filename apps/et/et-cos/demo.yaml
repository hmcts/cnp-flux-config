apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
  name: et-cos
spec:
  releaseName: et-cos
  values:
    java:
      image: hmctspublic.azurecr.io/et/cos:prod-35541a8-20240125102359 #{"$imagepolicy": "flux-system:demo-et-cos"}
      environment:
        RD_PROFESSIONAL_API_URL: http://rd-professional-api-demo.service.core-compute-demo.internal
        AAC_URL: http://aac-manage-case-assignment-demo.service.core-compute-demo.internal
        EXUI_CASE_DETAILS_URL: "https://manage-case.demo.platform.hmcts.net/cases/case-details/"
        CITIZEN_CASE_DETAILS_URL: "https://et-sya.demo.platform.hmcts.net/citizen-hub/"
        BUNDLE_URL: http://em-ccd-orchestrator-demo.service.core-compute-demo.internal/
        RESTART_MANUALLY: 1
        ET_COS_DB_HOST: et-cos-postgres-v15-demo.postgres.database.azure.com
        ET_COS_DB_NAME: et_cos
        ET_COS_DB_PORT: 5432
        ET_COS_DB_USER_NAME: pgadmin
      keyVaults:
        et-cos:
          secrets:
            - name: Ocp-Apim-Subscription-Key
              alias: ACAS_KEY
            - name: et-cos-s2s-secret
              alias: ET_COS_S2S_SECRET
            - name: cos-system-user
              alias: ET_COS_SYSTEM_USER
            - name: cos-system-user-password
              alias: ET_COS_SYSTEM_USER_PASSWORD
            - name: idam-client-secret
              alias: IDAM_CLIENT_SECRET
            - name: et-cos-postgres-password-v15
              alias: ET_COS_DB_PASSWORD
        et:
          secrets:
            - name: create-updates-queue-send-connection-string
              alias: CREATE_UPDATES_QUEUE_SEND_CONNECTION_STRING
            - name: app-insights-connection-string
              alias: app-insights-connection-string
            - name: tornado-access-key
              alias: TORNADO_ACCESS_KEY
            - name: gov-notify-api-key
              alias: GOV_NOTIFY_API_KEY
            - name: launch-darkly-sdk-key
              alias: LAUNCH_DARKLY_SDK_KEY
