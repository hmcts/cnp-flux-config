apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: ia-case-api
  namespace: ia
spec:
  releaseName: ia-case-api
  values:
    java:
      disableTraefikTls: true
      image: hmctspublic.azurecr.io/ia/case-api:prod-c0b62cb-20220429141633 #{"$imagepolicy": "flux-system:ia-case-api"}
      replicas: 2
      autoscaling:
        enabled: true
        maxReplicas: 5
        targetCPUUtilizationPercentage: 80
      useInterpodAntiAffinity: true
      environment:
        IS_SAVE_AND_CONTINUE_ENABLED: "false"
        IA_FEEPAYMENT_ENABLED: "true"
  chart:
    spec:
      releaseName: ia-case-api
      chart:
        git: git@github.com:hmcts/hmcts-charts
        ref: master
        path: stable/ia-case-api
      sourceRef:
        kind: HelmRepository
        name: hmctspublic
        namespace: flux-system
